<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ› ï¸ Panel Administrador â€“ ğŸ“šPEVE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>
<body class="theme-dark">

  <!-- GUARDIA DE SESIÃ“N ADMIN -->
  <script>
    (function () {
      try {
        const isAdmin = sessionStorage.getItem("adminLogged") === "1";
        if (!isAdmin) {
          window.location.href = "./login.html";
        }
      } catch (e) {
        window.location.href = "./login.html";
      }
    })();
  </script>

  <!-- HEADER GLOBAL -->
  <header class="topbar">
    <div class="topbar-left">
      <div class="logo-circle">ğŸ“š</div>
      <div class="brand-text">
        <span class="brand-name">PEVE</span>
        <span class="brand-subtitle">Panel de administraciÃ³n</span>
      </div>
    </div>

    <nav class="topbar-nav" aria-label="NavegaciÃ³n principal">
      <a href="../index.html" class="nav-link" data-i18n="nav.inicio">Inicio</a>
      <a href="../pages/asignaturas.html" class="nav-link" data-i18n="nav.asignaturas">Asignaturas</a>
      <span class="nav-link nav-link-active" data-i18n="nav.admin">Administrador</span>
      <a href="./informes.html" class="nav-link" data-i18n="nav.informes">Informes</a>
    </nav>

    <div class="accessibility-toolbar" aria-label="Controles de accesibilidad">
      <button class="access-btn" data-action="home" data-home="../index.html" title="Ir al inicio">ğŸ </button>
      <button class="access-btn" data-action="narrator" title="Leer el contenido de la pÃ¡gina">ğŸ—£ï¸</button>
      <button class="access-btn" data-action="toggle-theme" title="Cambiar tema claro/oscuro">ğŸŒ“</button>
      <button class="access-btn" data-action="font-inc" title="Aumentar tamaÃ±o de letra">A+</button>
      <button class="access-btn" data-action="font-dec" title="Disminuir tamaÃ±o de letra">Aâˆ’</button>
      <button class="access-btn" data-action="lang" title="Cambiar idioma ES/EN/FR">ğŸŒ</button>
      <button class="access-btn" data-action="guide" title="Mostrar guÃ­a paso a paso">ğŸ§ </button>
      <button class="access-btn" data-action="search" title="Buscar en esta pÃ¡gina">ğŸ”</button>
    </div>
  </header>

  <!-- CONTENIDO PRINCIPAL -->
  <main id="main-content" class="page">

    <!-- RESUMEN SUPERIOR -->
    <section class="section">
      <div class="section-header">
        <h1>Panel administrador</h1>
        <p class="page-lead">
          Gestiona usuarios PEVE, credenciales de acceso e informes de resultados (PEVE, DIA y KPSI) para estudiantes,
          apoderados, docentes y UTP.
        </p>
      </div>

      <div class="dashboard-grid">
        <article class="card">
          <h3>ğŸ‘¥ Usuarios PEVE</h3>
          <p class="note">
            Total de estudiantes cargados desde la hoja <code>PEVE_Usuarios</code>.
          </p>
          <p><strong id="admin-total-users">â€“</strong> estudiante(s)</p>
        </article>

        <article class="card">
          <h3>ğŸ“© EnvÃ­o de credenciales</h3>
          <p class="note">
            Selecciona un estudiante en la tabla y utiliza los botones para enviar las credenciales por correo o
            WhatsApp al apoderado.
          </p>
        </article>

        <article class="card">
          <h3>ğŸ“Š Informes y resultados</h3>
          <p class="note">
            Genera y comparte informes PEVE (resultados, DIA, KPSI) desde este panel o en el mÃ³dulo detallado de
            <strong>Informes</strong>.
          </p>
          <a href="./informes.html" class="btn btn-outline btn-card">Ir a informes detallados</a>
        </article>
      </div>
    </section>

    <!-- TABLA DE USUARIOS PEVE -->
    <section class="section">
      <div class="section-header">
        <h2>GestiÃ³n de usuarios PEVE</h2>
        <p>
          Datos sincronizados desde la hoja <code>PEVE_Usuarios</code> (o datos demo mientras se configura la API de
          Google Sheets). Selecciona un estudiante para trabajar informes y credenciales.
        </p>
      </div>

      <div class="table-wrapper">
        <table class="temario-table" id="admin-users-table">
          <thead>
            <tr>
              <th>ID PEVE</th>
              <th>Estudiante</th>
              <th>RUT</th>
              <th>Curso 2025</th>
              <th>Llamado</th>
              <th>Correo estudiante</th>
              <th>Apoderado</th>
              <th>Correo apoderado</th>
              <th>TelÃ©fono apoderado</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <!-- Filas dinÃ¡micas desde admin.js -->
          </tbody>
        </table>
      </div>
    </section>

    <!-- INFORMES RÃPIDOS PEVE Â· DIA Â· KPSI -->
    <section class="section admin-report-section">
      <div class="section-header">
        <h2>Informes rÃ¡pidos PEVE Â· DIA Â· KPSI</h2>
        <p class="page-lead">
          A partir del estudiante seleccionado puedes generar un informe breve para distintos destinatarios:
          estudiante, apoderado, docente o UTP / Equipo PIE. PEVE integra resultados de exÃ¡menes, informaciÃ³n de
          ingreso (DIA) y KPSI inicio / fin como insumos para el seguimiento.
        </p>
      </div>

      <div class="admin-report-steps callout-secondary">
        <p>
          <strong>Flujo sugerido:</strong>
          1ï¸âƒ£ Selecciona un estudiante en la tabla superior Â·
          2ï¸âƒ£ Elige tipo de informe y destinatario Â·
          3ï¸âƒ£ Ajusta el texto si lo deseas Â·
          4ï¸âƒ£ EnvÃ­a por correo o WhatsApp.
        </p>
        <p class="note">
          Por ahora el contenido es una plantilla demostrativa. MÃ¡s adelante podrÃ¡s inyectar resultados reales de
          PEVE, DIA y KPSI desde tus hojas de cÃ¡lculo.
        </p>
      </div>

      <div class="admin-report-grid">
        <!-- Columna izquierda: configuraciÃ³n + texto del informe -->
        <article class="card admin-report-main">
          <header class="admin-report-header">
            <span class="page-kicker">Informe rÃ¡pido Â· Borrador editable</span>
            <h3>ConfiguraciÃ³n del informe</h3>
          </header>

          <div class="admin-report-student">
            <span class="admin-report-label">Estudiante seleccionado</span>
            <p id="report-student-label" class="admin-report-student-name">
              Sin selecciÃ³n Â· selecciona una fila en la tabla de usuarios.
            </p>
          </div>

          <div class="admin-report-form">
            <div class="admin-report-field">
              <label for="report-type-select">Tipo de informe</label>
              <select id="report-type-select" class="admin-report-select">
                <option value="resumen-peve">Resumen PEVE (exÃ¡menes + avance)</option>
                <option value="dia">Informe de ingreso (DIA)</option>
                <option value="kpsi">Informe KPSI inicio / fin</option>
                <option value="mixto">Informe mixto (PEVE + DIA + KPSI)</option>
              </select>
            </div>

            <div class="admin-report-field">
              <label for="report-target-select">Destinatario principal</label>
              <select id="report-target-select" class="admin-report-select">
                <option value="estudiante">Estudiante</option>
                <option value="apoderado">Apoderado / tutor / cuidador</option>
                <option value="docente">Docente</option>
                <option value="utp">UTP / Equipo PIE</option>
              </select>
            </div>

            <div class="admin-report-tags">
              <button type="button" class="report-tag" data-report-type="dia">
                DIA Â· lÃ­nea de base
              </button>
              <button type="button" class="report-tag" data-report-type="kpsi">
                KPSI inicio / fin
              </button>
              <button type="button" class="report-tag" data-report-type="resumen-peve">
                Resultados por curso y asignatura
              </button>
              <button type="button" class="report-tag" data-report-type="mixto">
                Informe mixto (PEVE + DIA + KPSI)
              </button>
            </div>

            <div class="admin-report-field">
              <label for="report-preview">
                Vista previa del informe (puedes editar el texto antes de enviar)
              </label>
              <textarea id="report-preview"
                        rows="14"
                        class="admin-report-textarea"></textarea>
            </div>
          </div>
        </article>

        <!-- Columna derecha: tips + acciones de envÃ­o -->
        <aside class="card admin-report-side">
          <h3>Uso de este informe</h3>
          <ul class="bullet-list small">
            <li>Ajusta el tono y el detalle segÃºn el destinatario (estudiante, familia, docente o UTP / PIE).</li>
            <li>Puedes copiar el texto para informes DIA, actas de reuniÃ³n o fichas de seguimiento interno.</li>
            <li>A futuro se incorporarÃ¡n datos reales de PEVE, DIA y KPSI (grÃ¡ficos, porcentajes, etc.).</li>
          </ul>

          <div class="admin-report-actions">
            <button id="btn-report-email" type="button" class="btn btn-solid">
              ğŸ“© Enviar informe por correo
            </button>
            <button id="btn-report-whatsapp" type="button" class="btn btn-outline">
              ğŸ“± Enviar informe por WhatsApp
            </button>
            <a href="./informes.html" class="btn btn-ghost btn-card">
              Ver mÃ³dulo de informes completo
            </a>
          </div>

          <p class="note admin-report-note">
            Estos botones usan el correo / telÃ©fono del estudiante o apoderado asociado al registro seleccionado
            en la tabla. MÃ¡s adelante podrÃ¡s integrar correos de docentes y UTP especÃ­ficos por curso.
          </p>
        </aside>
      </div>
    </section>
  
<!-- Bloque de accesibilidad comÃºn PEVE -->
<section class="section">
  <article class="card accessibility-card" aria-label="InformaciÃ³n de accesibilidad de la plataforma PEVE">
    <h2>ğŸ§© Accesibilidad</h2>
    <p class="note">
      ğŸ› ï¸ Controles: ğŸ  inicio Â· ğŸ—£ï¸ lee todo el contenido de la pÃ¡gina Â· ğŸŒ“ alto contraste Â· A+ / Aâˆ’ tamaÃ±o de letra Â·
      ğŸŒ ES / EN / FR (traducciÃ³n del sitio) Â· ğŸ§  guÃ­a paso a paso Â· ğŸ” lupa.
    </p>
  </article>
</section>

</main>

  <!-- JS GLOBAL -->
  <script src="../assets/js/accesibilidad.js" defer></script>
  <script src="../assets/js/footer.js" defer></script>
  <script src="../assets/js/admin.js" defer></script>
</body>
</html>
