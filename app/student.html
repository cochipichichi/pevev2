<!DOCTYPE html>
<html lang="es"><head>
<meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>ğŸ‘©â€ğŸ“Estudiante â€” ğŸ“šPEVE</title>
<link href="../assets/style.css" rel="stylesheet"/>
<script defer="" src="../assets/app.js"></script>
<script>
window.addEventListener('DOMContentLoaded', async()=>{
  const u = (typeof getSession === 'function') ? getSession() : null;
  if(!u || u.role!=='student'){
    return location.href='login.html';
  }
  const whoEl = document.getElementById('who');
  if(whoEl) whoEl.textContent = u.name || u.id || 'Estudiante';

  // Recursos de BiologÃ­a 1M
  try{
    const course = await fetch('../data/courses.json')
      .then(r=>r.json())
      .then(j=>j["BiologÃ­a 1M"]);
    const ctn = document.getElementById('res');
    if(course && ctn && Array.isArray(course.resources)){
      course.resources.forEach(r=>{
        const a = document.createElement('a');
        a.className = 'btn';
        a.href = r.href;
        a.textContent = r.label;
        ctn.appendChild(a);
      });
    }
  }catch(e){
    console.warn('No se pudieron cargar recursos de BiologÃ­a 1M', e);
  }

  // Avance del estudiante (stats_by_student desde Sheets)
  try{
    if(window.PEVE_ADMIN && typeof PEVE_ADMIN.peveStatsByStudent === 'function'){
      const res = await PEVE_ADMIN.peveStatsByStudent(u.id);
      if(res && res.status === 'ok' && Array.isArray(res.rows) && res.rows.length){
        const main = document.querySelector('main');
        if(main){
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <h3>ğŸ“Š Mi avance en ğŸ“šPEVE</h3>
            <p>Resumen de tus intentos registrados en los quizzes.</p>
            <table class="table">
              <thead>
                <tr>
                  <th>Curso</th>
                  <th>OA</th>
                  <th>Intentos</th>
                  <th>Promedio</th>
                </tr>
              </thead>
              <tbody id="stats-student-self"></tbody>
            </table>
          `;
          main.appendChild(card);
          const tb = card.querySelector('#stats-student-self');
          res.rows.forEach(x=>{
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${x.courseId}</td><td>${x.oa}</td><td>${x.intentos}</td><td>${x.promedio}</td>`;
            tb.appendChild(tr);
          });
        }
      }
    }
  }catch(err){
    console.warn('No se pudo cargar stats_by_student para estudiante', err);
  }
});
</script>
<script defer="" src="../assets/api.js"></script>
<meta content="#0b0f14" name="theme-color"/>
<link href="../assets/css/theme.css" rel="stylesheet"/></head>
<body data-home="../index.html">
<header class="header">
<div class="logo">
<span class="badge" data-i18n="c.peve_63155b10">ğŸ“šPEVE</span>
<span class="title" data-i18n="c.plataforma_exÃ¡menes_de_validaciÃ³n_de_est_a925d25a">Plataforma ExÃ¡menes de ValidaciÃ³n de Estudios</span>
</div>
<div class="row">
<button class="toggle" data-action="fs-dec">Aâˆ’</button>
<button class="toggle" data-action="fs-inc">A+</button>
<button class="toggle" data-action="contrast" data-i18n="c.alto_contraste_32387669">ğŸŒ“ Alto contraste</button>
</div>
<div aria-label="Controles de accesibilidad" class="accessibility-toolbar" data-i18n-aria-label="c.attr.aria-label.controles_de_accesibilidad_e1513252">
<button class="access-btn" data-action="home" data-home="../index.html" data-i18n-title="c.attr.title.ir_al_inicio_115d499a" title="Ir al inicio">ğŸ </button>
<button class="access-btn" data-action="narrator" data-i18n-title="c.attr.title.leer_el_contenido_de_la_pÃ¡gina_b153cdac" title="Leer el contenido de la pÃ¡gina">ğŸ—£ï¸</button>
<button class="access-btn" data-action="toggle-theme" data-i18n-title="c.attr.title.cambiar_tema_clarooscuro_c39e5dae" title="Cambiar tema claro/oscuro">ğŸŒ“</button>
<button class="access-btn" data-action="font-inc" data-i18n-title="c.attr.title.aumentar_tamaÃ±o_de_letra_e7bb9209" title="Aumentar tamaÃ±o de letra">A+</button>
<button class="access-btn" data-action="font-dec" data-i18n-title="c.attr.title.disminuir_tamaÃ±o_de_letra_75a8c21b" title="Disminuir tamaÃ±o de letra">Aâˆ’</button>
<button class="access-btn" data-action="lang" data-i18n-title="c.attr.title.cambiar_idioma_esenfr_9e345c96" title="Cambiar idioma ES/EN/FR">ğŸŒ</button>
<button class="access-btn" data-action="guide" data-i18n-title="c.attr.title.mostrar_guÃ­a_paso_a_paso_c06bf245" title="Mostrar guÃ­a paso a paso">ğŸ§ </button>
<button class="access-btn" data-action="search" data-i18n-title="c.attr.title.buscar_en_esta_pÃ¡gina_90fa8efb" title="Buscar en esta pÃ¡gina">ğŸ”</button>
</div>
</header>
<main>
<div class="row" style="justify-content:space-between;align-items:center">
<h2>ğŸ‘©â€ğŸ“ Estudiante â€” <span id="who"></span></h2>
<button class="toggle" data-action="logout" data-i18n="c.cerrar_sesiÃ³n_f394d025">Cerrar sesiÃ³n</button>
</div>
<div class="card">
<h3 data-i18n="p.app__student.0001">BiologÃ­a 1Â° Medio â€” Recursos</h3>
<div class="row" id="res"></div>
</div>
<!-- Bloque de accesibilidad comÃºn PEVE -->
<section class="section">
<article aria-label="InformaciÃ³n de accesibilidad de la plataforma PEVE" class="card accessibility-card" data-i18n-aria-label="c.attr.aria-label.informaciÃ³n_de_accesibilidad_de_la_plata_fca079ae">
<h2 data-i18n="c.accesibilidad_fd501df9">ğŸ§© Accesibilidad</h2>
<p class="note" data-i18n="c.controles__inicio___lee_todo_el_contenid_573aa174">
      ğŸ› ï¸ Controles: ğŸ  inicio Â· ğŸ—£ï¸ lee todo el contenido de la pÃ¡gina Â· ğŸŒ“ alto contraste Â· A+ / Aâˆ’ tamaÃ±o de letra Â·
      ğŸŒ ES / EN / FR (traducciÃ³n del sitio) Â· ğŸ§  guÃ­a paso a paso Â· ğŸ” lupa.
    </p>
</article>
</section>
</main>
<footer class="footer small">
<div class="footer-inner">
<!-- <div class="footer-logo"> -->
<div class="footer-bar">
<div class="logo"><img alt="Neotech EduLab" class="logo-img" data-i18n-alt="c.attr.alt.neotech_edulab_ef78e95d" onerror="this.style.display='none'" src="../assets/logo.svg"/>
<div><strong>Â© <strong data-i18n="c.neotech_edulab_985e1a35">Neotech EduLab</strong>-EducaciÃ³n Inmersiva</strong></div>
<small data-i18n="c.prohibida_su_copia_yo_reproducciÃ³n_d83cfd46">ğŸ› ï¸Prohibida su copia y/o reproducciÃ³n</small>
</div>
</div>
<div class="footer-text">
<!-- <img src="../assets/img/logo-peve.svg" alt="Logo PEVE" class="logo-img" onerror="this.style.display='none'">
        <p><strong>Neotech EduLab Â· EducaciÃ³n Inmersiva</strong></p> -->
<p>Â© 2025 <strong data-i18n="c.peve_63155b10">ğŸ“šPEVE</strong> â€“ Plataforma de ExÃ¡menes de ValidaciÃ³n de Estudios Â· Hecho con â¤ï¸ y enfoque inclusivo.</p>
<p class="footer-note" data-i18n="c.peve_es_un_recurso_pedagÃ³gico_complement_a28eeb20">
          PEVE es un recurso pedagÃ³gico complementario. La inscripciÃ³n, rendiciÃ³n y certificaciÃ³n de ExÃ¡menes Libres
          depende exclusivamente del Ministerio de EducaciÃ³n de Chile y sus canales oficiales.
        </p>
</div>
</div>
</footer>

<script defer="" src="../assets/js/main.js"></script>
<script src="../assets/js/accessibility.js"></script></body></html>
