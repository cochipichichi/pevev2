<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§ª Quiz Historia 8Â° bÃ¡sico â€“ PEVE</title>
  <link rel="stylesheet" href="../../../../../assets/css/style.css">
  <link rel="stylesheet" href="../../../../../assets/css/peve-cards.css">
  <link rel="icon" type="image/svg+xml" href="../../../../../assets/logo.svg">
  <script src="../../../../../assets/js/accessibility.js" defer></script>
  <script src="../../../../../assets/js/config.js" defer></script>
  <script src="../../../../../assets/js/peve-backend.js" defer></script>
</head>
<body class="theme-dark">
  <header class="topbar">
    <div class="topbar-left">
      <div class="logo-circle" aria-hidden="true">ğŸ“š</div>
      <div class="brand-text">
        <span class="brand-name">PEVE</span>
        <span class="brand-subtitle">Plataforma de ExÃ¡menes de ValidaciÃ³n de Estudios</span>
      </div>
    </div>
    <nav class="topbar-nav" aria-label="NavegaciÃ³n principal">
      <a href="../../../../../index.html" class="nav-link" data-i18n="nav.inicio">Inicio</a>
      <a href="../../../../../pages/info.html" class="nav-link" data-i18n="nav.proceso">Proceso</a>
      <a href="../../../../../pages/niveles.html" class="nav-link" data-i18n="nav.niveles">Niveles</a>
      <a href="../../../../../pages/asignaturas.html" class="nav-link" data-i18n="nav.asignaturas">Asignaturas</a>
      <a href="../../../../../pages/perfiles.html" class="nav-link" data-i18n="nav.perfiles">Perfiles</a>
      <a href="../../../../../pages/accesibilidad.html" class="nav-link" data-i18n="nav.accesibilidad">Accesibilidad</a>
      <a href="../../../../../pages/acerca.html" class="nav-link" data-i18n="nav.acerca">Acerca de</a>
    </nav>

    <div class="accessibility-toolbar" aria-label="Controles de accesibilidad">
      <button class="access-btn" data-action="home" data-home="../../../../../index.html" title="Ir al inicio">ğŸ </button>
      <button class="access-btn" data-action="narrator" title="Leer el contenido de la pÃ¡gina">ğŸ—£ï¸</button>
      <button class="access-btn" data-action="toggle-theme" title="Cambiar tema claro/oscuro">ğŸŒ“</button>
      <button class="access-btn" data-action="font-inc" title="Aumentar tamaÃ±o de letra">A+</button>
      <button class="access-btn" data-action="font-dec" title="Disminuir tamaÃ±o de letra">Aâˆ’</button>
      <button class="access-btn" data-action="lang" title="Cambiar idioma ES/EN/FR">ğŸŒ</button>
      <button class="access-btn" data-action="guide" title="Mostrar guÃ­a paso a paso">ğŸ§ </button>
      <button class="access-btn" data-action="search" title="Buscar en esta pÃ¡gina">ğŸ”</button>
    </div>
  </header>

<main id="main-content" class="page-main">
  <section class="section">
    <header class="section-header">
      <h1>ğŸ§ª Quiz de prÃ¡ctica â€“ Historia y GeografÃ­a 8Â° bÃ¡sico</h1>
      <p>Responde estas preguntas tipo PEVE basadas en el banco de Historia 8Â°. Al final podrÃ¡s ver tu puntaje y quÃ© Ã­tems revisar.</p>
    </header>

    <form id="quiz-form" class="quiz-form">
      <div class="quiz-intro">
        <label>
          Nombre del estudiante:
          <input type="text" id="student-name" required />
        </label>
        <label>
          Curso:
          <input type="text" id="student-course" placeholder="8Â° bÃ¡sico" />
        </label>
      </div>

      <div id="quiz-items" class="quiz-items">
        <!-- Preguntas se inyectan vÃ­a JS -->
      </div>

      <div class="quiz-actions">
        <button type="submit" class="btn btn-solid">âœ… Enviar respuestas</button>
        <button type="button" class="btn btn-outline" id="reset-quiz">â™» Limpiar intento</button>
      </div>
    </form>

    <section id="quiz-results" class="quiz-results" hidden>
      <h2>Resultados</h2>
      <p id="score-text"></p>
      <table class="results-table">
        <thead>
          <tr>
            <th>#</th>
            <th>OA / Tema</th>
            <th>Tu respuesta</th>
            <th>Correcta</th>
          </tr>
        </thead>
        <tbody id="results-body"></tbody>
      </table>
    </section>
  </section>
</main>

  <footer class="footer small">
    <div class="footer-inner">
      <div class="footer-bar">
        <div class="logo">
          <img src="../../../../../assets/logo.svg" alt="Neotech EduLab" class="logo-img" onerror="this.style.display='none'">
          <div><strong>Â© <strong>Neotech EduLab</strong>-EducaciÃ³n Inmersiva</div>
          <small>ğŸ› ï¸Prohibida su copia y/o reproducciÃ³n</small>
        </div>
      </div>
      <div class="footer-text">
        <p>Â© 2025 <strong>ğŸ“šPEVE</strong> â€“ Plataforma de ExÃ¡menes de ValidaciÃ³n de Estudios Â· Hecho con â¤ï¸ y enfoque inclusivo.</p>
        <p class="footer-note">
          PEVE es un recurso pedagÃ³gico complementario. La inscripciÃ³n, rendiciÃ³n y certificaciÃ³n de ExÃ¡menes Libres
          depende exclusivamente del Ministerio de EducaciÃ³n de Chile y sus canales oficiales.
        </p>
      </div>
    </div>
  </footer>

<script>
// Subconjunto de preguntas inspiradas en el banco PEVE de Historia 8Â°.
const QUESTIONS = [
  {
    id: 1,
    oa: "HI08 OA02-04",
    prompt: "Â¿QuÃ© cambios permitiÃ³ la imprenta en la Europa de la Edad Moderna?",
    options: [
      "FacilitÃ³ la difusiÃ³n de ideas cientÃ­ficas y religiosas, permitiendo cuestionar la autoridad de la Iglesia.",
      "FortaleciÃ³ el control de la Iglesia al limitar el acceso a los libros.",
      "EliminÃ³ los conflictos religiosos entre catÃ³licos y protestantes.",
      "EvitÃ³ la circulaciÃ³n de panfletos polÃ­ticos y religiosos."
    ],
    answer: 0
  },
  {
    id: 2,
    oa: "HI08 OA07",
    prompt: "Un rasgo central de las monarquÃ­as absolutas europeas fue:",
    options: [
      "La separaciÃ³n estricta de poderes entre rey y parlamento.",
      "La concentraciÃ³n del poder polÃ­tico en la figura del rey.",
      "La elecciÃ³n periÃ³dica del rey por votaciÃ³n popular.",
      "La desapariciÃ³n de la nobleza y el clero."
    ],
    answer: 1
  },
  {
    id: 3,
    oa: "HI08 OA11",
    prompt: "En la sociedad colonial americana, los criollos se caracterizaban por:",
    options: [
      "Ser descendientes de europeos nacidos en AmÃ©rica.",
      "Ser indÃ­genas que se habÃ­an convertido al cristianismo.",
      "Ser esclavos africanos reciÃ©n llegados al continente.",
      "Ser funcionarios enviados directamente desde EspaÃ±a."
    ],
    answer: 0
  },
  {
    id: 4,
    oa: "HI08 OA21",
    prompt: "Una idea fundamental de la IlustraciÃ³n fue que:",
    options: [
      "La autoridad del rey provenÃ­a directamente de Dios y no debÃ­a cuestionarse.",
      "La razÃ³n y el conocimiento podÃ­an mejorar la sociedad y la polÃ­tica.",
      "Las tradiciones debÃ­an mantenerse sin cambios a lo largo del tiempo.",
      "Solo la nobleza podÃ­a participar de la vida polÃ­tica."
    ],
    answer: 1
  },
  {
    id: 5,
    oa: "GeografÃ­a / Medioambiente",
    prompt: "Un conflicto socioambiental se produce cuando:",
    options: [
      "Solo hay escasez de recursos naturales.",
      "Las decisiones sobre el uso del territorio generan tensiones entre actores con intereses distintos.",
      "Los paÃ­ses firman acuerdos para proteger el medioambiente.",
      "Se incrementa el Ãndice de Desarrollo Humano (IDH) en una regiÃ³n."
    ],
    answer: 1
  }
];

const quizContainer = document.getElementById("quiz-items");
const form = document.getElementById("quiz-form");
const resultsSection = document.getElementById("quiz-results");
const resultsBody = document.getElementById("results-body");
const scoreText = document.getElementById("score-text");
const resetBtn = document.getElementById("reset-quiz");

function renderQuiz() {
  quizContainer.innerHTML = "";
  QUESTIONS.forEach((q, idx) => {
    const block = document.createElement("article");
    block.className = "quiz-item";
    block.innerHTML = `
      <h3>Pregunta ${idx + 1} <small>(${q.oa})</small></h3>
      <p>${q.prompt}</p>
      <div class="quiz-options">
        ${
          q.options.map((opt, i) => `
            <label class="quiz-option">
              <input type="radio" name="q${q.id}" value="${i}" required />
              <span>${opt}</span>
            </label>
          `).join("")
        }
      </div>
    `;
    quizContainer.appendChild(block);
  });
}

form.addEventListener("submit", (e) => {
  e.preventDefault();
  let correct = 0;
  resultsBody.innerHTML = "";

  QUESTIONS.forEach((q, idx) => {
    const selected = form.querySelector(`input[name="q${q.id}"]:checked`);
    const selectedIndex = selected ? parseInt(selected.value, 10) : -1;
    const isCorrect = selectedIndex === q.answer;
    if (isCorrect) correct++;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${idx + 1}</td>
      <td>${q.oa}</td>
      <td>${selectedIndex >= 0 ? q.options[selectedIndex] : "â€”"}</td>
      <td>${q.options[q.answer]}</td>
    `;
    row.classList.add(isCorrect ? "row-correct" : "row-incorrect");
    resultsBody.appendChild(row);
  });

  const scorePercent = Math.round((correct / QUESTIONS.length) * 100);
  scoreText.textContent = `Aciertos: ${correct} de ${QUESTIONS.length} (${scorePercent}%).`;
  resultsSection.hidden = false;

  const payload = {
    name: document.getElementById("student-name").value || "",
    course: document.getElementById("student-course").value || "",
    correct,
    total: QUESTIONS.length,
    scorePercent,
    ts: new Date().toISOString()
  };
  try {
    const key = "peve_historia8_quiz";
    const prev = JSON.parse(localStorage.getItem(key) || "[]");
    prev.push(payload);
    localStorage.setItem(key, JSON.stringify(prev));
  } catch (err) {
    console.warn("No se pudo guardar en localStorage", err);
  }

  // Enviar tambiÃ©n a Google Sheets vÃ­a Apps Script (modo demo)
  if (window.PEVE_BACKEND) {
    window.PEVE_BACKEND.sendQuizResult({
      userName: payload.name,
      course: payload.course || "8Â° BÃ¡sico",
      module: "Historia y GeografÃ­a 8Â° â€“ Quiz demo",
      score: correct,
      max: QUESTIONS.length,
      q1: "Historia 8Â°",
      q2: "Quiz banco PEVE"
    }).then((res) => {
      if (res && res.status === "ok") {
        console.log("[PEVE] Quiz enviado a Sheets");
      } else {
        console.warn("[PEVE] No se pudo enviar quiz a Sheets", res);
      }
    }).catch((err) => {
      console.warn("[PEVE] Error al enviar quiz a Sheets", err);
    });
  }
});

resetBtn.addEventListener("click", () => {
  form.reset();
  resultsSection.hidden = true;
});

renderQuiz();
</script>

</body>
</html>
