<!DOCTYPE html>
<html lang="es">
<head>
<meta content="#0c0f10" name="theme-color"/>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>ğŸŸï¸ Ticket de salida â€” OA2</title>
<link href="../style.css" rel="stylesheet"/>
<script defer="" src="../../../../../assets/app.js"></script>
<script defer="" src="../../../../../assets/api.js"></script>
<link href="../../../../../assets/css/theme.css" rel="stylesheet"/></head>
<body>
<nav class="controls">
<span class="control-title" data-i18n="c.controles_e9be6793">ğŸ› ï¸ Controles:</span>
<a class="control-btn" href="../index.html">ğŸ </a>
<button class="control-btn" onclick="handleSpeak()">ğŸ—£ï¸</button>
<div class="theme-switcher">
<button aria-label="Cambiar tema" class="control-btn" data-i18n-aria-label="c.attr.aria-label.cambiar_tema_4156dabc" data-i18n-title="c.attr.title.temas_altt_58abcf47" id="themeBtn" onclick="toggleThemeMenu()" title="Temas (Alt+T)">ğŸŒ“</button>
<div aria-label="Selector de tema" class="theme-menu hidden" data-i18n-aria-label="c.attr.aria-label.selector_de_tema_a0c5920a" id="themeMenu" role="menu">
<button data-i18n="c.claro_e8e44533" onclick="setTheme('light')" role="menuitem">â˜€ï¸ Claro</button>
<button data-i18n="c.oscuro_27a6408f" onclick="setTheme('dark')" role="menuitem">ğŸŒ™ Oscuro</button>
<button data-i18n="c.alto_contraste_745b631c" onclick="setTheme('high')" role="menuitem">âš¡ Alto contraste</button>
<button data-i18n="c.sepia_0bd3eacb" onclick="setTheme('sepia')" role="menuitem">ğŸ“œ Sepia</button>
</div>
</div>
<button class="control-btn" onclick="fontDelta(1)">A+</button>
<button class="control-btn" onclick="fontDelta(-1)">Aâˆ’</button>
<button class="control-btn" onclick="toggleLang(this)">ğŸŒ</button>
<button class="control-btn" onclick="toggleGuide(true)">ğŸ§ </button>
<button class="control-btn" onclick="toggleRuler(this)">ğŸ”</button>
<span class="spacer"></span>
<button class="control-btn" onclick="handleStop()">â¹</button>
</nav>
<main class="section" id="intro">
<h1 data-i18n="c.ticket_de_salida__oa2_1cc81cc3">ğŸŸï¸ Ticket de salida â€” OA2</h1>
<div class="card">
<ol>
<li>Escribe una evidencia que <strong data-i18n="c.apoye_c26f785a">apoye</strong> la evoluciÃ³n y explica por quÃ©.</li>
<li data-i18n="c.en_la_simulaciÃ³n_quÃ©_variable_te_ayudÃ³_a_81579154">En la simulaciÃ³n, Â¿quÃ© variable te ayudÃ³ a entender la selecciÃ³n natural?</li>
<li data-i18n="c.una_idea_de_darwinwallace_que_te_parezca_49f01165">Una idea de Darwin/Wallace que te parezca clave (y por quÃ©).</li>
</ol>
<p><em data-i18n="c.tip_2ee750e0">Tip:</em> puedes copiar tus respuestas y pegarlas en Google Classroom o imprimir esta pÃ¡gina.</p>
<div class="ticket-form">
<h2 data-i18n="c.escribe_tus_respuestas_0fa91243">âœï¸ Escribe tus respuestas</h2>
<label>
          1) Evidencia que apoya la evoluciÃ³n
          <textarea data-i18n-placeholder="c.attr.placeholder.escribe_aquÃ­_tu_respuesta_2883180d" id="t_learned" placeholder="Escribe aquÃ­ tu respuesta..." rows="3"></textarea>
</label>
<label>
          2) Variable de la simulaciÃ³n que te ayudÃ³ a entender la selecciÃ³n natural
          <textarea data-i18n-placeholder="c.attr.placeholder.escribe_aquÃ­_tu_respuesta_2883180d" id="t_doubt" placeholder="Escribe aquÃ­ tu respuesta..." rows="3"></textarea>
</label>
<label>
          3) Idea clave de Darwin/Wallace
          <textarea data-i18n-placeholder="c.attr.placeholder.escribe_aquÃ­_tu_respuesta_2883180d" id="t_example" placeholder="Escribe aquÃ­ tu respuesta..." rows="3"></textarea>
</label>
<p class="note" data-i18n="c.si_estÃ¡s_trabajando_con_peve_y_has_inici_49a810aa">
          Si estÃ¡s trabajando con ğŸ“šPEVE y has iniciado sesiÃ³n como estudiante, puedes guardar este ticket en tu registro.
        </p>
</div>
</div>
<div class="btn-row" style="margin-top:1rem">
<button class="btn" data-i18n="c.imprimir__guardar_pdf_4b17601d" onclick="window.print()">ğŸ–¨ï¸ Imprimir / Guardar PDF</button>
<a class="btn" data-i18n="c.volver_5d3047a4" href="../index.html">â¬…ï¸ Volver</a>
<button class="btn" data-i18n="c.guardar_en_peve_95c7be39" onclick="saveTicket()">ğŸ’¾ Guardar en PEVE</button>
</div>
<!-- Bloque de accesibilidad comÃºn PEVE -->
<section class="section">
<article aria-label="InformaciÃ³n de accesibilidad de la plataforma PEVE" class="card accessibility-card" data-i18n-aria-label="c.attr.aria-label.informaciÃ³n_de_accesibilidad_de_la_plata_fca079ae">
<h2 data-i18n="c.accesibilidad_fd501df9">ğŸ§© Accesibilidad</h2>
<p class="note" data-i18n="c.controles__inicio___lee_todo_el_contenid_573aa174">
      ğŸ› ï¸ Controles: ğŸ  inicio Â· ğŸ—£ï¸ lee todo el contenido de la pÃ¡gina Â· ğŸŒ“ alto contraste Â· A+ / Aâˆ’ tamaÃ±o de letra Â·
      ğŸŒ ES / EN / FR (traducciÃ³n del sitio) Â· ğŸ§  guÃ­a paso a paso Â· ğŸ” lupa.
    </p>
</article>
</section>
</main>
<div class="modal" id="guideModal"><div class="box"><span class="close" onclick="toggleGuide(false)">âœ–</span><h3 data-i18n="c.guÃ­a_22cd2fea">ğŸ§  GuÃ­a</h3><p data-i18n="c.responde_con_frases_breves_y_ejemplos_co_008dde83">Responde con frases breves y ejemplos concretos.</p></div></div>
<div class="ruler" id="ruler"></div>
<script src="../js/script.js"></script>
<script>
    async function saveTicket(){
      const learned = document.getElementById('t_learned')?.value.trim() || '';
      const doubt   = document.getElementById('t_doubt')?.value.trim() || '';
      const example = document.getElementById('t_example')?.value.trim() || '';
      if(!learned && !doubt && !example){
        alert('Escribe al menos una respuesta antes de guardar el ticket.');
        return;
      }
      try{
        const u = (typeof getSession === 'function') ? getSession() : null;
        if(!u || !u.id){
          alert('Para guardar el ticket en PEVE, primero ingresa por el panel de Estudiante.');
          return;
        }
        if(!window.PEVE_API || typeof PEVE_API.pevePost !== 'function'){
          alert('La API de PEVE no estÃ¡ configurada (revisa data/config.json y assets/api.js).');
          return;
        }
        await PEVE_API.pevePost('ticket_submit', {
          timestamp: new Date().toISOString(),
          userId: u.id,
          userName: u.name || '',
          course: 'BiologÃ­a 1M',
          module: 'OA2',
          learned,
          doubt,
          example
        });
        alert('Ticket guardado en tu registro PEVE (Google Sheets).');
      }catch(err){
        console.warn('No se pudo enviar el ticket a Sheets (ticket_submit).', err);
        alert('OcurriÃ³ un problema al enviar el ticket. IntÃ©ntalo mÃ¡s tarde.');
      }
    }
  </script>
<script src="../../../../../assets/js/accessibility.js"></script></body>
</html>
